<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kontakt | BATTIPAV</title>

    <!-- Critical CSS - okamžité skrytí obsahu během načítání -->
    <style>
        .config-loading { opacity: 0; }
        body { transition: opacity 0.15s ease-in; }
    </style>

    <link rel="stylesheet" href="assets/css/variables.css">
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/main.css">

    <script src="assets/js/config-loader.js"></script>
    <script src="assets/js/main.js" defer></script>
</head>
<body class="config-loading">
    <!-- Header -->
    <header class="header">
        <div class="header__main">
            <div class="container">
                <div class="header__content">
                    <div class="header__logo">
                        <a href="index.html">
                            <img id="main-logo" src="assets/images/battipav/logo.svg" alt="Logo">
                        </a>
                    </div>
                    <div class="header__info">
                        <div class="header__official"><span id="brand-name-header">BATTIPAV</span> Česká republika</div>
                        <div class="header__distributor" id="distributor-name">NTC STAVEBNÍ TECHNIKA spol. s r.o.</div>
                        <div class="header__contact">
                            <a href="tel:" id="header-phone"></a>
                            <span style="color: #2c2c2c; margin: 0 4px;">|</span>
                            <a href="mailto:" id="header-email"></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <nav class="nav">
            <div class="container">
                <div class="nav__controls">
                    <button class="nav__toggle" id="nav-toggle">☰ Menu</button>
                    <button class="nav__header-toggle" id="header-toggle">▲</button>
                </div>
                <ul class="nav__list" id="nav-list"></ul>
            </div>
        </nav>
    </header>

    <!-- Page Header -->
    <section class="hero" style="padding: var(--spacing-xl) 0;">
        <div class="container">
            <h1 class="hero__title">Kontakt</h1>
        </div>
    </section>

    <!-- Contact Content -->
    <section class="section">
        <div class="container">
            <div class="grid grid--2">
                <!-- Contact Form -->
                <div>
                    <h2 style="color: var(--color-secondary);">Kontaktní formulář</h2>
                    <p style="margin-bottom: var(--spacing-lg); color: var(--color-text-light);">
                        Máte dotaz? Vyplňte formulář níže a my se vám ozveme co nejdříve.
                    </p>

                    <form id="contact-form" class="contact-form">
                        <input type="hidden" name="_replyto" id="_replyto">
                        <input type="hidden" name="_subject" id="_subject">
                        <div class="form__group">
                            <label for="name" class="form__label">Jméno a příjmení *</label>
                            <input type="text" id="name" name="name" class="form__input" required>
                        </div>

                        <div class="form__group">
                            <label for="email" class="form__label">Email *</label>
                            <input type="email" id="email" name="email" class="form__input" required>
                        </div>

                        <div class="form__group">
                            <label for="phone" class="form__label">Telefon</label>
                            <input type="tel" id="phone" name="phone" class="form__input">
                        </div>

                        <div class="form__group">
                            <label for="subject" class="form__label">Předmět *</label>
                            <input type="text" id="subject" name="subject" class="form__input" required>
                        </div>

                        <div class="form__group">
                            <label for="message" class="form__label">Zpráva *</label>
                            <textarea id="message" name="message" class="form__textarea" required></textarea>
                        </div>

                        <button type="submit" id="submit-btn" class="btn btn--primary">Odeslat zprávu</button>

                        <div id="form-success" style="display:none; margin-top: var(--spacing-md); padding: var(--spacing-md); background: #e8f5e9; border-left: 4px solid #4caf50; border-radius: var(--radius-sm); color: #2e7d32;">
                            Zpráva byla úspěšně odeslána. Ozveme se vám co nejdříve.
                        </div>
                        <div id="form-error" style="display:none; margin-top: var(--spacing-md); padding: var(--spacing-md); background: #fdecea; border-left: 4px solid #f44336; border-radius: var(--radius-sm); color: #c62828;">
                            Při odesílání došlo k chybě. Zkuste to prosím znovu nebo nás kontaktujte telefonicky.
                        </div>
                    </form>
                </div>

                <!-- Contact Info -->
                <div>
                    <h2 style="color: var(--color-secondary);">Kontaktní údaje</h2>
                    <p style="margin-bottom: var(--spacing-lg); color: var(--color-text-light);">
                        Neváhejte nás kontaktovat telefonicky nebo emailem.
                    </p>

                    <div class="contact-info" style="background-color: var(--color-background-gray); padding: var(--spacing-md); border-radius: var(--radius-md);">
                        <h3 id="contact-distributor-name" style="margin-bottom: var(--spacing-md); color: var(--color-secondary);"></h3>

                        <div style="margin-bottom: var(--spacing-sm);">
                            <strong style="color: var(--color-secondary);">Adresa:</strong><br>
                            <span id="contact-address" style="color: var(--color-text);"></span>
                        </div>

                        <div style="margin-bottom: var(--spacing-sm);">
                            <strong style="color: var(--color-secondary);">Telefon:</strong><br>
                            <a href="tel:" id="contact-phone" style="color: var(--color-primary);"></a>
                        </div>

                        <div style="margin-bottom: var(--spacing-sm);">
                            <strong style="color: var(--color-secondary);">Email:</strong><br>
                            <a href="mailto:" id="contact-email" style="color: var(--color-primary);"></a>
                        </div>

                        <div style="margin-bottom: var(--spacing-sm);">
                            <strong style="color: var(--color-secondary);">IČO:</strong> <span id="contact-ico" style="color: var(--color-text);"></span><br>
                            <strong style="color: var(--color-secondary);">DIČ:</strong> <span id="contact-dic" style="color: var(--color-text);"></span>
                        </div>
                    </div>

                    <div style="margin-top: var(--spacing-lg);">
                        <h3 style="color: var(--color-secondary);">Provozní doba</h3>
                        <p style="color: var(--color-text);">
                            Pondělí - Pátek: 7:00 - 15:00<br>
                            Sobota - Neděle: Zavřeno
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Mapa - celá šířka -->
    <section style="padding: 0;">
        <div style="background-color: var(--color-background-gray); padding: var(--spacing-md) 0;">
            <div class="container">
                <h3 style="color: var(--color-secondary); margin-bottom: var(--spacing-sm); margin-top: 15px; text-align: center;">Kde nás najdete</h3>
            </div>
        </div>
        <iframe
            src="https://frame.mapy.cz/turisticka?source=firm&id=153366&x=16.0361513&y=50.3952621&z=18"
            width="100%"
            height="400"
            frameborder="0"
            style="border: 0; display: block;"
            allowfullscreen>
        </iframe>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__main">
                <div class="grid grid--4">
                    <div class="footer__col">
                        <h3 class="footer__title" id="footer-brand-name">BATTIPAV</h3>
                        <p id="footer-brand-description"></p>
                    </div>

                    <div class="footer__col">
                        <h3 class="footer__title">Produkty</h3>
                        <a href="electric-saws.html" class="footer__link">Elektrické pily</a>
                        <a href="manual-cutters.html" class="footer__link">Ruční řezačky</a>
                        <a href="large-format-tools.html" class="footer__link">Velkoformátové nástroje</a>
                        <a href="mixers.html" class="footer__link">Mixéry</a>
                        <a href="floor-cleaners.html" class="footer__link">Čističky podlah</a>
                    </div>

                    <div class="footer__col">
                        <h3 class="footer__title">Informace</h3>
                        <a href="about.html" class="footer__link">O společnosti</a>
                        <a href="catalogue.html" class="footer__link">Katalog</a>
                        <a href="contact.html" class="footer__link">Kontakt</a>
                    </div>

                    <div class="footer__col">
                        <h3 class="footer__title">Kontakt</h3>
                        <p id="footer-distributor-name"></p>
                        <p id="footer-address"></p>
                        <p id="footer-phone"></p>
                        <p id="footer-email"></p>
                    </div>
                </div>
            </div>

            <div class="footer__bottom">
                <p>&copy; <span id="current-year"></span> <span id="footer-copyright"></span>. Všechna práva vyhrazena.</p>
            </div>
        </div>
    </footer>

    <script>
        // Naplnění kontaktních údajů
        document.addEventListener('brandConfigLoaded', (e) => {
            const config = e.detail;
            const distributor = config.getDistributor();

            const contactDistributorName = document.getElementById('contact-distributor-name');
            if (contactDistributorName) contactDistributorName.textContent = distributor.name;

            const contactAddress = document.getElementById('contact-address');
            if (contactAddress) contactAddress.textContent = distributor.address || 'Adresa bude doplněna';

            const contactPhone = document.getElementById('contact-phone');
            if (contactPhone && distributor.phone) {
                contactPhone.href = `tel:${distributor.phone}`;
                contactPhone.textContent = distributor.phone;
            } else if (contactPhone) {
                contactPhone.textContent = 'Telefon bude doplněn';
            }

            const contactEmail = document.getElementById('contact-email');
            if (contactEmail && distributor.email) {
                contactEmail.href = `mailto:${distributor.email}`;
                contactEmail.textContent = distributor.email;
            } else if (contactEmail) {
                contactEmail.textContent = 'Email bude doplněn';
            }

            const contactIco = document.getElementById('contact-ico');
            if (contactIco) contactIco.textContent = distributor.ico || 'Bude doplněno';

            const contactDic = document.getElementById('contact-dic');
            if (contactDic) contactDic.textContent = distributor.dic || 'Bude doplněno';
        });

        // Zpracování formuláře přes Formspree
        const FORMSPREE_ID = 'xgollgyq';

        document.getElementById('contact-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const form = e.target;
            const btn = document.getElementById('submit-btn');
            const successMsg = document.getElementById('form-success');
            const errorMsg = document.getElementById('form-error');

            // Naplnění skrytých polí před odesláním
            document.getElementById('_replyto').value = document.getElementById('email').value;
            const subjectVal = document.getElementById('subject').value;
            document.getElementById('_subject').value = `Zpráva z webu BATTIPAV: ${subjectVal}`;

            btn.disabled = true;
            btn.textContent = 'Odesílám...';
            successMsg.style.display = 'none';
            errorMsg.style.display = 'none';

            try {
                const response = await fetch(`https://formspree.io/f/${FORMSPREE_ID}`, {
                    method: 'POST',
                    body: new FormData(form),
                    headers: { 'Accept': 'application/json' }
                });

                if (response.ok) {
                    form.reset();
                    successMsg.style.display = 'block';
                } else {
                    errorMsg.style.display = 'block';
                }
            } catch {
                errorMsg.style.display = 'block';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Odeslat zprávu';
            }
        });
    </script>
</body>
</html>
